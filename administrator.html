<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - Groundwater System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="text-center mb-5">üåä Groundwater Prediction Admin Panel</h2>

    <div class="row g-4">

      <!-- Climate Data Form -->
      <div class="col-md-6">
        <div class="card p-4 shadow-lg rounded-4">
          <h5 class="mb-3">üåßÔ∏è Add Rainfall & Climate Data</h5>
          <form id="climateForm">
            <div class="mb-3">
              <label for="climateDate" class="form-label">Date</label>
              <input type="date" class="form-control" id="climateDate" required>
            </div>
            <div class="mb-3">
              <label for="rainfall" class="form-label">Rainfall (mm)</label>
              <input type="number" class="form-control" id="rainfall" step="0.01" required>
            </div>
            <div class="mb-3">
              <label for="temperature" class="form-label">Temperature (¬∞C)</label>
              <input type="number" class="form-control" id="temperature" step="0.01" required>
            </div>
            <button type="submit" class="btn btn-success w-100">Submit Climate Data</button>
          </form>
          <div id="climateResult" class="mt-3"></div>
        </div>
      </div>

      <!-- Prediction Form -->
      <div class="col-md-6">
        <div class="card p-4 shadow-lg rounded-4">
          <h5 class="mb-3">ü§ñ Predict Groundwater Level</h5>
          <form id="predictionForm">
            <div class="mb-3">
              <label for="predictDate" class="form-label">Date</label>
              <input type="date" class="form-control" id="predictDate" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Predict & Store</button>
          </form>
          <div id="predictionResult" class="mt-3"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Climate data submission
    document.getElementById("climateForm").addEventListener("submit", async function (e) {
      e.preventDefault();
  
      const date = document.getElementById("climateDate").value;
      const rainfall = parseFloat(document.getElementById("rainfall").value);
      const temperature = parseFloat(document.getElementById("temperature").value);
  
      const climateEntry = {
        date: date,
        rainfall: rainfall,
        temperature: temperature,
        source: "admin-panel"
      };
  
      try {
        const res = await fetch("/api/predictions/admin/climate", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(climateEntry)
        });
  
        const data = await res.json();
        document.getElementById("climateResult").innerHTML = `
          <div class="alert alert-success">
            ‚úÖ ${data.message} for <strong>${date}</strong>.
          </div>
        `;
      } catch (err) {
        document.getElementById("climateResult").innerHTML = `
          <div class="alert alert-danger">
            ‚ùå Failed to save climate data.
          </div>
        `;
      }
    });
  
    // Prediction submission
    document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("predictionForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const date = document.getElementById("predictDate").value;
    const predictedValue = 10.41;

    const predictionEntry = {
      date: date,
      predictedGroundwaterLevel: parseFloat(predictedValue),
      source: "model"
    };

    try {
      const res = await fetch("/api/predictions/admin/predict", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(predictionEntry)
      });

      const data = await res.json();
      document.getElementById("predictionResult").innerHTML = `
        <div class="alert alert-info">
          üìÖ <strong>${date}</strong> ‚Üí Predicted GW Level: <strong>${predictedValue} m</strong> <br/>
          ‚úÖ ${data.message}
        </div>
      `;
    } catch (err) {
      document.getElementById("predictionResult").innerHTML = `
        <div class="alert alert-danger">
          ‚ùå Prediction failed to save.
        </div>
      `;
    }
  });
});
  </script>
  
</body>
</html>
